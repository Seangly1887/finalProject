<div class="cart-container">
  <div class="cart-items">
    @for(item of cartService.GetCartItems(); track item.id){
      <div class="cart-item">  
          <img [src]="item.image" alt="Product">
          <div class="item-details">
            <h4>{{item.title}}</h4>
            <p>{{item.description}}</p>
            <p class="item_price">${{item.price | currency}} </p>
          </div>
          <div class="item-quantity">
            <button (click)="cartService.decreaseQuantity(item)">-</button>
            <span>{{item.qty}}</span>
            <button (click)="cartService.increaseQuantity(item)">+</button>
          </div>
          <div class="item-total">${{item.price * item.qty | currency}}</div>
          <div class="item-actions">
            <button class="remove-btn" (click)="cartService.removeItem(item)">âœ–</button>
            <input type="checkbox" class="item-checkbox" [checked]="item.is_selected " 
                   (change)="cartService.selectItem(item)">
          </div>
        </div>
    }
    @if(cartService.GetCartItems().length === 0){
      <div class="empty-cart">
        <h2>Your cart is empty</h2>
        <a routerLink="/">ðŸ‘‰Continue Shopping</a>
      </div>
    }
    @if(cartService.GetCartItems().length > 0){
      <div class="cart-summary">
        <h3>Total: <span class="total">{{cartService.getCartTotal() | currency}} </span></h3>
        <button class="checkout-btn" (click)="openPayment()">Checkout </button>
      </div>
    }
<!-- Popup overlay -->
<div class="payment-popup" [class.show]="showPaymentPopup">
  <div class="popup-content">
    <h2>Selected Products</h2>
    @for(item of cartService.GetCartItems(); track item.id){
      @if(item.is_selected && item.qty > 0){
        <div class="product-row">
          <img [src]="item.image" alt="{{ item.name }}" class="product-image" />
          <span>{{ item.title }}</span>
            <span class="priceProduct">{{ item.price | currency }}</span>
          </div>
          <div class="product-quantity">
            <h6>Quantity: {{ item.qty }}</h6>
            <h6>Total: {{ item.price * item.qty | currency }}</h6>
          </div>  
        } 
      }
      <h3 class="total">
        Total:
        <span>
          {{getSelectedTotal() | currency}}
        </span>
      </h3>
    
      <form #paymentForm="ngForm" (ngSubmit)="submitPayment(paymentForm)">
        <label>
          Card Number:
          <input type="text" name="cardNumber" ngModel required pattern="[0-9]{16}">
        </label>
        <label>
          CVV:
          <input type="password" name="cvv" ngModel required pattern="[0-9]{3}">
        </label>
        <div class="form-actions">
          <button type="submit" [disabled]="paymentForm.invalid">Pay Now</button>
          <button type="button" (click)="closePayment()">Cancel</button>
        </div>
      </form>
    </div>
  </div>

