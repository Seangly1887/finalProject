<div class="cart-container">
  <div class="cart-items">
    @for(item of cartService.GetCartItems(); track item.id){
      <div class="cart-item">  
          <img [src]="item.image" alt="Product">
          <div class="item-details">
            <h4>{{item.title}}</h4>
            <p>{{item.description}}</p>
            <p>${{item.price | currency}} </p>
          </div>
          <div class="item-quantity">
            <button (click)="cartService.decreaseQuantity(item)">-</button>
            <span>{{item.qty}}</span>
            <button (click)="cartService.increaseQuantity(item)">+</button>
          </div>
          <div class="item-total">${{item.price * item.qty}}</div>
          <div class="item-actions">
            <button class="remove-btn" (click)="cartService.removeItem(item)">âœ–</button>
            <input type="checkbox" class="item-checkbox" [checked]="item.is_selected " 
                   (change)="cartService.selectItem(item)">
          </div>
        </div>
    }
    @if(cartService.GetCartItems().length === 0){
      <div class="empty-cart">
        <h2>Your cart is empty</h2>
        <a routerLink="/">ðŸ‘‰Continue Shopping</a>
      </div>
    }
    @if(cartService.GetCartItems().length > 0){
      <div class="cart-summary">
        <h3>Total: <span>{{cartService.getCartTotal() | currency}} </span></h3>
        <button class="checkout-btn" (click)="openPayment()">Checkout </button>
      </div>
    }
<!-- Popup overlay -->
<div
  class="popup-overlay"
  [class.show]="showPaymentPopup"
  (click)="closePayment()"
>
  <div class="popup-content" (click)="$event.stopPropagation()">
    <h3>Payment Form</h3>
    <form #paymentForm="ngForm" (ngSubmit)="submitPayment(paymentForm)">
      <label>
        Card Number
        <input
          name="cardNumber"
          ngModel
          required
          minlength="16"
          maxlength="16"
          placeholder="1234 5678 9012 3456"
        />
      </label>

      <label>
        Expiry Date
        <input
          name="expiry"
          ngModel
          required
          pattern="^(0[1-9]|1[0-2])\/?([0-9]{2})$"
          placeholder="MM/YY"
        />
      </label>

      <label>
        CVV
        <input
          name="cvv"
          type="password"
          ngModel
          required
          minlength="3"
          maxlength="4"
          placeholder="123"
        />
      </label>

      <button type="submit" [disabled]="paymentForm.invalid">
        Pay {{ cartService.getCartTotal() | currency }}
      </button>
      <button type="button" (click)="closePayment()">Cancel</button>
    </form>
  </div>
</div>